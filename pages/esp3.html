<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>ardylab</title>
  <link rel="shortcut icon"href="../images/myicon.ico">
  <link rel="stylesheet" href="../style.css">
</head>
<body>

  <div class="divdiv"><a href="../index.html"><img src="../images/logo.jpg" class="leftfoto"  ></a><p> Здесь расположены небольшие скетчи (прошивки) для esp8266 для быстрой проверки различных плат и пр.</p></div>

<div class="divdiv d">
   <a href="../pages/esp.html" class="pagination">1</a>
   <a href="../pages/esp2.html" class="pagination">2</a>
   <a href="../pages/esp3.html" class="pagination color">3</a>
   <a href="../pages/404.html" class="pagination">4</a>
   <a href="../pages/404.html" class="pagination">5</a>
 </div>

  <div class="divdiv di"></a><p>Давайте в этом примере разберемся с прерываниями микроконтролера ESP8266. Прерывания очень полезная функция в микроконтроллере так как он может выполнять свою прошивку не замечая ничего, крутясь в своих бесконечных циклах как карапуз на карусели, а прерывания то что способно его одернуть и заставить делать то что нам надо. Например у нас есть новогодняя гирлянда которая переливается различными огнями, мы хотим переключить ее в другой режим и тут нам поможет прерывание, оно остановит мигание и мы выполним что хотим. В скетче у нас есть<a href="../pages/esp.html#esp_button"> кнопка </a>  которая будет задействовать прерывание, микроконтроллер все бросит и выполнит функцию прикрепленную к прерыванию, а затем вернется к воим действиям. В функции прерывания есть событие при котором сработает прерывание : FALLING - переход на низкий уровень (замыкание пина на 0), RISING - переход на высокий уровень (подача на пин +3.3 вольта), CHANGE – когда меняется состояние вывода (если было +3.3 вольта и поменялось на 0 или наоборот было 0 стало 3.3 вольта). В ESP8266 прерывания можно настроить практически на любой пин микроконтроллера.  </p>
<a name="esp_interrupt"></a>

<pre class="ide"><code>
<span class="ide-keyword">void</span>
 <span class="ide-system-keyword">setup</span>() {  <span class="ide-line-comment">                             // функция настроек и разового ввода данных</span>
  <span class="ide-platform-function">pinMode</span> (D4, <span class="ide-keyword">OUTPUT</span>);                  <span class="ide-line-comment">// д4 пин настраиваем на выход, на нем светодиод</span>
  <span class="ide-platform-function">pinMode</span> (D1, <span class="ide-keyword">INPUT_PULLUP</span>);            <span class="ide-line-comment">// д1 пин настраиваем на вход, с подтяжкой +3.3 вольта на пин</span>
  attachInterrupt (D1, <span class="ide-platform-function">blink</span>, FALLING);  <span class="ide-line-comment">// включаем прерывание на д1 пине, (пин, выполняемая функция, событие)</span>
}
<span class="ide-keyword">void</span> <span class="ide-system-keyword">loop</span>() {                            <span class="ide-line-comment">// запускаем бесконечную обработку кода (цикл)</span>
  <span class="ide-platform-function">digitalWrite</span>(D4, 1);                   <span class="ide-line-comment">// светодиод гаснет</span>
  <span class="ide-platform-function">delay</span>(500);                            <span class="ide-line-comment">// ожидание в течение пол секунды</span>
  <span class="ide-platform-function">digitalWrite</span>(D4, 0);                   <span class="ide-line-comment">// светодиод загорается</span>
  <span class="ide-platform-function">delay</span>(500);                            <span class="ide-line-comment">// ожидание в течение пол секунды</span>
}
IRAM_ATTR <span class="ide-keyword">void</span> <span class="ide-platform-function">blink</span> () {                <span class="ide-line-comment">// функция выполняемая при прерывании</span>
  <span class="ide-platform-function">delay</span>(3000);                           <span class="ide-line-comment">// ожидание в течение 3 секунд, выполнение того что нам надо!</span>
}
</code></pre>

<img src="../images/esp_button.jpg" class="foc" tabindex="1">
</div>


  <div class="divdiv di"></a><p>Подключаем один из самых популярных дисплеев OLED 128x64 0.96 Inch к ЕСП. Данный дислей очень часто встречается в различных проектах так как не дорогой, яркий, работает без подсветки и соответственно потребляет небольшой ток, так же дислей подключается всего по 4 проводам что сильно облегчает работу с ним. Данный дисплей пригодится для часов, игрушек, панелей управления различными устройствами, для вывода ошибок оборудования, моточасов, весов и пр. так как может выводить не только текст но и графику. Подключается дислей по шине I2C в которой всего два провода пин D1-SCL и пин D2-SDA , дисплей питается как от 5 так и от 3.3 вольта что позволяет использовать его как в Ардуино так и в ЕСП. Для нашего скетча необходимо установить две библиотеки одну для шины I2C, вторую для <a href="../files/ESP8266_and_ESP32_OLED_driver_for_SSD1306_displays.zip" download> дисплея </a>, как устанавливать и где скачивать библиотеки есть много информации в интернете. </p>
<a name="esp_oled_Hello world"></a>

<pre class="ide"><code>
<span class="ide-system-keyword">#include</span> &lt;Wire.h&gt;                      <span class="ide-line-comment">// Подключаем библиотеку Wire.h для I2C интерфейса</span>
<span class="ide-system-keyword">#include</span> <span class="ide-string">&quot;SSD1306Wire.h&quot;</span>               <span class="ide-line-comment">// Подключаем библиотеку SSD1306.h для работы с дисплеем</span>
SSD1306Wire display(0x3c, SDA, SCL);   <span class="ide-line-comment">// (ADDRESS, SDA, SCL) Адрес дисплея на шине I2C</span>
<span class="ide-keyword">void</span> <span class="ide-system-keyword">setup</span>() {                         <span class="ide-line-comment">// функция настроек и разового ввода данных</span>
  display.init();                      <span class="ide-line-comment">// инициализация дисплея</span>
  display.flipScreenVertically();      <span class="ide-line-comment">// переворачиваем верх низ если необходимо, иначе строку удаляем</span>
  display.setFont(ArialMT_Plain_16);   <span class="ide-line-comment">// устанавливаем шрифт на дисплее</span>
}
<span class="ide-keyword">void</span> <span class="ide-system-keyword">loop</span>() {                          <span class="ide-line-comment">// запускаем бесконечную обработку кода (цикл)</span>
  display.clear();                     <span class="ide-line-comment">// очистка дисплея от старой записи</span>
  <span class="ide-platform-function">delay</span>(1000);                         <span class="ide-line-comment">// задержка 1 секунда</span>
  display.drawString(0, 0, <span class="ide-string">&quot;Hello world&quot;</span>);  <span class="ide-line-comment">// место на дисплее и текст для вывода</span>
  display.display();                   <span class="ide-line-comment">//передаем на дисплей информацию</span>
}

</code></pre>

<img src="../images/esp_oled_Hello world.jpg" class="foc" tabindex="1">
</div>



<div class="divdiv d">
   <a href="../pages/esp.html" class="pagination">1</a>
   <a href="../pages/esp2.html" class="pagination">2</a>
   <a href="../pages/esp3.html" class="pagination color">3</a>
   <a href="../pages/404.html" class="pagination">4</a>
   <a href="../pages/404.html" class="pagination">5</a>
 </div>



</body>
</html>


